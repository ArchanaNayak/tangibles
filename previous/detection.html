<!DOCTYPE html>
<html>
<head>
<script src="scripts/Tangibles.js"></script>

<script>


	
function myFunction() {
    document.getElementById("textRun").innerHTML = populate();
	//document.getElementById("textRecognize").innerHTML = recognize();
	//document.getElementById("textLoadTangibles").innerHTML = Load();
};

function populate(){
	return testPopulateC();
};

function save(){
	return testSave();
};

function recognize(){
	var touches =[[35,65],[25,15],[15,50],[55,65]];  
	// [[15,50],[35,65],[25,15],[55,65]]; //with touch points not in order  translation by x=5,y=10 //[[0,0],[0,30],[40,0]];
	var identifiedTangible = tangibleRecognizer(touches);
	var jsonText = JSON.stringify(identifiedTangible);
	document.getElementById("textLoadTangibles").innerHTML = jsonText;
};

function testReorientate(){
	//var touches =[[25,15],[15,50],[35,65],[55,65]]; // [[20,5],[10,40],[30,55],[50,55]];  //[[0,0],[0,30],[40,0]];
	//var identifiedTangible = tangibleRecognizer(touches);
	var stickNew = new Tangible();
	id=6;
	tangibleName='another boar';
	touchPoints=[[15,50],[25,15],[55,65],[35,65]]; 
	//[[15,50],[25,15],[35,65],[55,65]];//[[25,15],[15,50],[35,65],[55,65]]; // touch points are in original order translation by x=5,y=1
	//[[15,50],[35,65],[25,15],[55,65]]; //with touch points not in order  translation by x=5,y=10[[25,15],[15,50],[35,65],[55,65]];  // [[20,5],[10,40],[30,55],[50,55]];  //[[0,0],[0,30],[40,0]];
	outline=[];
	stickNew=stickNew.populateC(id,tangibleName,touchPoints,outline);
	
	
	var jsonText = JSON.stringify(stickNew);
	document.getElementById("textLoadTangibles").innerHTML = jsonText;
	var firsttime=true;
	var freezeOutline=true;
	var g=[];
	
	
	//Recognize
	var identifiedTangible = tangibleRecognizer(touchPoints);
	var jsonText = JSON.stringify(identifiedTangible);
	document.getElementById("textRecognize").innerHTML = jsonText;
	
	//ReOrientate
	var pose=reorientate(identifiedTangible, stickNew, g, firsttime, freezeOutline);
	var jsonText2 = JSON.stringify(pose);
	document.getElementById("textReorientate").innerHTML = jsonText2;

};

function Load(){
	return testPopulateC();
};

function testCalculateDistances(){
	var leaf = new Tangible();
	leaf.type = "leaf";
	leaf.ID=1;
	leaf.touchPoints[0]=[0,0];
	leaf.touchPoints[1]=[0,40];
	leaf.touchPoints[2]=[30,0];
	return leaf.calculateDistances();
};

//Test method for Calibration Constructor
function testPopulateC(){
	var leaf = new Tangible();
	// Method arguments id,  name,  touches,  outline
	var id=1;
	var tangibleName='leaf';
	var touchPoints=[[10,10],[10,40],[50,10]];
	var outline=[[0,0],[0,50],[60,0]];
	return leaf.populateC(id,tangibleName,touchPoints,outline); 
	 
};

function testSave(){

	var savingTangibles= JSON.parse(localStorage.getItem('tangibles'));
	
	var leaf = new Tangible();
	// Method arguments id,  name,  touches,  outline
	var id=1;
	var tangibleName='leaf';
	var touchPoints=[[10,10],[10,40],[50,10]];
	var outline=[];
	leaf.populateC(id,tangibleName,touchPoints,outline); 
	savingTangibles.push(leaf);
	
	var stick = new Tangible();
	// Method arguments id,  name,  touches,  outline
	id=2;
	tangibleName='stick';
	touchPoints=[[10,15],[10,40],[10,55]];
	outline=[];
	stick.populateC(id,tangibleName,touchPoints,outline); 
	savingTangibles.push(stick);
	
	var stick = new Tangible();
	// Method arguments id,  name,  touches,  outline
	id=3;
	tangibleName='boar';
	touchPoints=[[20,5],[10,40],[30,55],[50,55]];
	outline=[];
	stick.populateC(id,tangibleName,touchPoints,outline); 
	savingTangibles.push(stick);
	
	localStorage.setItem('tangibles', JSON.stringify(savingTangibles));

	// Example of how to transform the String generated through 
	// JSON.stringify and saved in localStorage in JSON object again
	tangiblesList= JSON.parse(localStorage.getItem('tangibles'));
	var jsonText = JSON.stringify(tangiblesList);
		document.getElementById("textLoadTangibles").innerHTML = jsonText;
};

//Test method for Tangible Identification Constructor
function testPopulateI(){
	var leaf = new Tangible();
	// Method arguments touch points
	var touchPoints=[[10,10],[10,50],[40,10]];
	var outline=[];
	return leaf.populateI(touchPoints); 
	
};

function addNewTangible(){
	var stick2 = new Tangible();
	// Method arguments id,  name,  touches,  outline
	//var id=1;
	var tangibleName='stick2';
	var touchPoints=[[12,15],[121,40],[56,13]];
	var orientation =0;
	//leaf.populateC(id,tangibleName,touchPoints,outline); 
	tangiblesList= JSON.parse(localStorage.getItem('tangibles'));
	Save(tangiblesList, orientation, touchPoints, tangibleName);
};

function deleteTangibles(){

	tangiblesList= [];
	localStorage.setItem('tangibles', JSON.stringify(tangiblesList));
	
};

function loadTangibles(){
	tangiblesList=JSON.parse(localStorage.getItem('tangibles'));
	var jsonText = JSON.stringify(tangiblesList);
	document.getElementById("textLoadTangibles").innerHTML = jsonText;
};
</script> 

</head>
<body>

<h1>Tangibles</h1>


<p id="textCalibrate"></p>
<p id="textLoadTangibles"></p>
<p id="textRecognize"></p>
<p id="textReorientate"></p>



<button type="button" onclick="addNewTangible()">Add New</button>
<button type="button" onclick="testSave()">Test Save</button>
<button type="button" onclick="recognize()">Recognize</button>
<button type="button" onclick="testReorientate()">Reorientate</button>
<br>
<button type="button" onclick="loadTangibles()">Load Tangibles</button>
<button type="button" onclick="deleteTangibles()">Delete All Tangibles</button>
<button type="button" onclick="myFunction()">Run</button>
<button type="button" onclick="myFunction()">Calibrate</button>



</body>
</html>
